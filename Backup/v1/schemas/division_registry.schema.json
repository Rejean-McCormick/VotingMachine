{
  "$defs": {
    "id_token": {
      "$comment": "ID token: 1..64 chars; allowed: A–Z a–z 0–9 underscore _ hyphen - colon : dot .",
      "maxLength": 64,
      "minLength": 1,
      "pattern": "^[A-Za-z0-9_.:-]{1,64}$",
      "title": "IdToken",
      "type": "string"
    },
    "name_200": {
      "maxLength": 200,
      "minLength": 1,
      "title": "Name200",
      "type": "string"
    },
    "option": {
      "additionalProperties": false,
      "properties": {
        "name": {
          "$ref": "#/$defs/name_200"
        },
        "option_id": {
          "$ref": "#/$defs/id_token"
        },
        "order_index": {
          "minimum": 0,
          "title": "OrderIndex",
          "type": "integer"
        }
      },
      "required": [
        "option_id",
        "name",
        "order_index"
      ],
      "title": "Option",
      "type": "object"
    },
    "unit": {
      "additionalProperties": false,
      "properties": {
        "name": {
          "$ref": "#/$defs/name_200"
        },
        "options": {
          "items": {
            "$ref": "#/$defs/option"
          },
          "minItems": 1,
          "title": "Options",
          "type": "array"
        },
        "protected_area": {
          "title": "ProtectedArea",
          "type": "boolean"
        },
        "unit_id": {
          "$ref": "#/$defs/id_token"
        }
      },
      "required": [
        "unit_id",
        "name",
        "protected_area",
        "options"
      ],
      "title": "Unit",
      "type": "object"
    }
  },
  "$id": "https://example.com/schemas/division_registry.schema.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "additionalProperties": false,
  "description": "DivisionRegistry schema (normative). Mirrors Doc 1 shape exactly; ordering/uniqueness are enforced by validation/tests, not by JSON Schema.",
  "examples": [
    {
      "schema_version": "1.x",
      "units": [
        {
          "unit_id": "U-001",
          "name": "District 1",
          "protected_area": false,
          "options": [
            {
              "option_id": "O-A1",
              "name": "Option A",
              "order_index": 1
            },
            {
              "option_id": "O-B1",
              "name": "Option B",
              "order_index": 2
            }
          ]
        }
      ]
    }
  ],
  "properties": {
    "schema_version": {
      "title": "SchemaVersion",
      "type": "string"
    },
    "units": {
      "items": {
        "$ref": "#/$defs/unit"
      },
      "minItems": 1,
      "title": "Units",
      "type": "array"
    }
  },
  "required": [
    "schema_version",
    "units"
  ],
  "title": "DivisionRegistry",
  "type": "object",
  "$comment": "Canonical JSON (UTF-8, LF, sorted keys). Ordering contracts (units by unit_id; options by order_index) and property-uniqueness (unit_id across units; option_id/order_index within a unit) are normative but enforced outside the schema."
}

